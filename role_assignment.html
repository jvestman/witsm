
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Role Assignment Request Form</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body class="bg-light">
    <div class="container my-5">
      <h1 class="mb-4">Role Assignment Request Form</h1>
      
<form id="role_assignment_request" action="#" method="post" class="p-4 bg-white rounded shadow-sm">
  
  <fieldset class="mb-4 border p-3 rounded">
    
      <legend class="fw-bold">Request Overview</legend>
    

    
    
      
        
    <div class="card mb-3">
      
      <div class="card-body">
        <p>This form is used to request the assignment of a role to a person within the organization.<br />
Each role defines a set of responsibilities and specifies the IT/information assets and permissions associated with it.<br />
By submitting this request, you indicate that the individual requires this role to perform their job duties.<br />
Access will only be granted after approval through the access management workflow.</p>
      </div>
    </div>
    
      
    
  </fieldset>
  
  <fieldset class="mb-4 border p-3 rounded">
    
      <legend class="fw-bold">Requestor Information</legend>
    

    
    
      
        
<div class="mb-3">
  <label for="requestor_name" class="form-label">Your Name *</label>
  <input type="text" class="form-control" id="requestor_name" name="requestor_name"
         placeholder="Enter your full name" required>
</div>
      
        
<div class="mb-3">
  <label for="requestor_email" class="form-label">Your Email *</label>
  <input type="text" class="form-control" id="requestor_email" name="requestor_email"
         placeholder="Enter your work email" required>
</div>
      
    
  </fieldset>
  
  <fieldset class="mb-4 border p-3 rounded">
    
      <legend class="fw-bold">Person to be Assigned</legend>
    

    
    
      
        
<div class="mb-3">
  <label for="person_name" class="form-label">Person's Name *</label>
  <input type="text" class="form-control" id="person_name" name="person_name"
         placeholder="Full name of the person" required>
</div>
      
        
<div class="mb-3">
  <label for="person_email" class="form-label">Person's Email *</label>
  <input type="text" class="form-control" id="person_email" name="person_email"
         placeholder="Work email of the person" required>
</div>
      
        
<div class="mb-3">
  <label for="home_organization" class="form-label">Home Organization / Department *</label>
  <input type="text" class="form-control" id="home_organization" name="home_organization"
         placeholder="e.g., IT, HR, Finance" required>
</div>
      
    
  </fieldset>
  
  <fieldset class="mb-4 border p-3 rounded">
    
      <legend class="fw-bold">Role Assignment Details</legend>
    

    
    
      
        
<div class="mb-3">
  <label for="role_name" class="form-label">Role to be Assigned *</label>
  <input type="text" class="form-control" id="role_name" name="role_name"
         placeholder="e.g., Full Stack Developer Component X" required>
</div>
      
        
<div class="mb-3">
  <label for="role_scope" class="form-label">Role Scope *</label>
  <select class="form-select" id="role_scope" name="role_scope" required>
    
      <option value="global">Global</option>
    
      <option value="department">Department</option>
    
      <option value="project">Project</option>
    
      <option value="system">System / Workspace</option>
    
  </select>
</div>
      
        
<div class="mb-3">
  <label for="start_date" class="form-label">Requested Start Date *</label>
  <input type="date" class="form-control" id="start_date" name="start_date"
         required>
</div>
      
        
<div class="mb-3">
  <label for="end_date" class="form-label">Requested End Date</label>
  <input type="date" class="form-control" id="end_date" name="end_date"
         >
</div>
      
        
<div class="mb-3">
  <label for="justification_category" class="form-label">Justification Category *</label>
  <select class="form-select" id="justification_category" name="justification_category" required>
    
      <option value="regular">Regular Duties</option>
    
      <option value="incident">Incident / Problem Management</option>
    
      <option value="vacation">Vacation Fill-in / Temporary Coverage</option>
    
      <option value="project">Project / Initiative</option>
    
  </select>
</div>
      
        
<div class="mb-3">
  <label for="justification_text" class="form-label">Justification / Purpose *</label>
  <textarea class="form-control" id="justification_text" name="justification_text" rows="4"
            placeholder="Explain why this role assignment is needed" required></textarea>
</div>
      
    
  </fieldset>
  
  <fieldset class="mb-4 border p-3 rounded">
    
      <legend class="fw-bold">Information Assets and Permissions Required</legend>
    

    
      <div class="row">
        
          <div class="col-md-12">
            
              
<div class="mb-3">
  <label for="asset_1_name" class="form-label">Information Asset 1 *</label>
  <input type="text" class="form-control" id="asset_1_name" name="asset_1_name"
         placeholder="Name of system, database, workspace, or service" required>
</div>
            
              
<div class="mb-3">
  <label for="asset_1_permissions" class="form-label">Permissions for Asset 1 *</label>
  <input type="text" class="form-control" id="asset_1_permissions" name="asset_1_permissions"
         placeholder="e.g., read, write, admin" required>
</div>
            
          </div>
        
          <div class="col-md-12">
            
              
<div class="mb-3">
  <label for="asset_2_name" class="form-label">Information Asset 2</label>
  <input type="text" class="form-control" id="asset_2_name" name="asset_2_name"
         placeholder="Name of system, database, workspace, or service" >
</div>
            
              
<div class="mb-3">
  <label for="asset_2_permissions" class="form-label">Permissions for Asset 2</label>
  <input type="text" class="form-control" id="asset_2_permissions" name="asset_2_permissions"
         placeholder="e.g., read, write, admin" >
</div>
            
          </div>
        
          <div class="col-md-12">
            
              
<div class="mb-3">
  <label for="asset_3_name" class="form-label">Information Asset 3</label>
  <input type="text" class="form-control" id="asset_3_name" name="asset_3_name"
         placeholder="Name of system, database, workspace, or service" >
</div>
            
              
<div class="mb-3">
  <label for="asset_3_permissions" class="form-label">Permissions for Asset 3</label>
  <input type="text" class="form-control" id="asset_3_permissions" name="asset_3_permissions"
         placeholder="e.g., read, write, admin" >
</div>
            
          </div>
        
      </div>
    
    
  </fieldset>
  

  <div class="d-flex gap-2 flex-wrap">
    <button type="submit" class="btn btn-primary">Submit</button>
    <button type="button" class="btn btn-outline-secondary" onclick="downloadFormCopy()">Download Copy</button>
    <button type="button" class="btn btn-outline-success" onclick="downloadFormAsEML()">Download as EML</button>
    <button type="button" class="btn btn-outline-info" onclick="shareFormURL()">Share via URL</button>
    <button type="button" class="btn btn-outline-warning" onclick="mailtoForm()">Email Link</button>
  </div>

</form>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    
    <script>
function prepareFormValues() {
  document.querySelectorAll('input, textarea, select').forEach(el => {
    if (el.type === 'checkbox' || el.type === 'radio') {
      if (el.checked) el.setAttribute('checked', 'checked');
      else el.removeAttribute('checked');
    } else if (el.tagName.toLowerCase() === 'select') {
      Array.from(el.options).forEach(opt => {
        if (opt.value === el.value) opt.setAttribute('selected', 'selected');
        else opt.removeAttribute('selected');
      });
    } else if (el.tagName.toLowerCase() === 'textarea') {
      el.textContent = el.value;
    } else {
      el.setAttribute('value', el.value);
    }
  });
  return "<!DOCTYPE html>\n" + document.documentElement.outerHTML;
}

function getFormValues() {
  const data = {};
  document.querySelectorAll('input, textarea, select').forEach(el => {
    if (!el.name) return;
    if (el.type === 'checkbox') {
      if (!data[el.name]) data[el.name] = [];
      if (el.checked) data[el.name].push(el.value);
    } else if (el.type === 'radio') {
      if (el.checked) data[el.name] = el.value;
    } else {
      data[el.name] = el.value;
    }
  });
  return data;
}

function setFormValues(data) {
  for (const [name, value] of Object.entries(data)) {
    const elements = document.querySelectorAll(`[name="${name}"]`);
    elements.forEach(el => {
      if (el.type === 'checkbox') {
        el.checked = Array.isArray(value) ? value.includes(el.value) : value === el.value;
      } else if (el.type === 'radio') {
        el.checked = el.value === value;
      } else {
        el.value = value;
      }
    });
  }
}

function interpolate(template, values) {
  if (!template) return '';
  return template.replace(/\$\{(\w+)\}/g, (_, key) => values[key] || '');
}

function downloadFormCopy() {
  const html = prepareFormValues();
  const timestamp = new Date().toISOString().replace(/[:T]/g, '-').split('.')[0];
  const filename = `filled_form_${timestamp}.html`;
  const blob = new Blob([html], { type: 'text/html' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = filename;
  a.click();
  URL.revokeObjectURL(a.href);
}

function downloadFormAsEML() {
  const html = prepareFormValues();
  const values = getFormValues();
  const boundary = "----=_Boundary_" + Math.random().toString(36).slice(2);
  const timestamp = new Date().toISOString().replace(/[:T]/g, '-').split('.')[0];
  const filename = `filled_form_${timestamp}.eml`;

  const from = interpolate(emlConfig.from || "no-reply@example.com", values);
  const to = interpolate(emlConfig.to || "recipient@example.com", values);
  const subject = interpolate(emlConfig.subject || "Completed Form Submission", values);

  const emlParts = [
    `From: ${from}`,
    `To: ${to}`,
    `Subject: ${subject}`,
    "MIME-Version: 1.0",
    `Content-Type: multipart/alternative; boundary=\"${boundary}\"`,
    "",
    `--${boundary}`,
    "Content-Type: text/plain; charset=utf-8",
    "",
    "Your email client does not support HTML. The completed form is below.",
    "",
    `--${boundary}`,
    "Content-Type: text/html; charset=utf-8",
    "Content-Transfer-Encoding: base64",
    "",
    btoa(unescape(encodeURIComponent(html))),
    "",
    `--${boundary}--`
  ];

  const emlContent = emlParts.join("\r\n");
  const blob = new Blob([emlContent], { type: 'message/rfc822' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = filename;
  a.click();
  URL.revokeObjectURL(a.href);
}

// ðŸ†• Serialize form into URL fragment and navigate
function shareFormURL() {
  const data = getFormValues();
  const encoded = encodeURIComponent(JSON.stringify(data));
  const newURL = `${window.location.pathname}#data=${encoded}`;
  history.replaceState(null, '', newURL);
  alert('âœ… URL updated! You can now copy and share this link.');
}

// ðŸ†• Generate mailto: link with serialized URL fragment
function mailtoForm() {
  const data = getFormValues();
  const encoded = encodeURIComponent(JSON.stringify(data));
  const formURL = `${window.location.origin}${window.location.pathname}#data=${encoded}`;

  const values = getFormValues();

  // Use template interpolation (same as EML)
  const to = interpolate(emlConfig.to || "recipient@example.com", values);
  const subject = interpolate(emlConfig.subject || "Form Link", values);

  // Email body with clickable URL
  const body = encodeURIComponent(
    `Here is the link to the filled form:

${formURL}

`
  );

  const mailto = `mailto:${encodeURIComponent(to)}?subject=${encodeURIComponent(subject)}&body=${body}`;
  window.location.href = mailto;
}


// ðŸ†• On load, populate form from URL fragment
window.addEventListener('DOMContentLoaded', () => {
  const match = window.location.hash.match(/^#data=(.+)$/);
  if (match) {
    try {
      const decoded = JSON.parse(decodeURIComponent(match[1]));
      setFormValues(decoded);
    } catch (e) {
      console.warn('Failed to parse form data from URL fragment:', e);
    }
  }
});

// Injected from YAML
const emlConfig = {"from": "no-reply@example.com", "subject": "New Role Assignment Request", "to": "access-control@example.com"};
</script>

  </body>
</html>